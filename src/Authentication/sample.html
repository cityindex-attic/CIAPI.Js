<!doctype html>
<head>
    <title>Authentication demo</title>

    <!--[! We expect these to already be loaded in the "deployment" page -->
    <script type="text/javascript" src="/publish/libs/jquery/1.6.1/jQuery.debug.js"></script>
    <script type="text/javascript" src="/publish/libs/jquery.tmpl.min.js"></script>
    <script type="text/javascript" src="/publish/libs/json2.js"></script>
    <script type="text/javascript" src="/publish/libs/jquery-ui/1.8.11/js/jquery-ui.min.js"></script>

    <link type="text/css" href="/publish/libs/themes/ci.default/ci.default.css" rel="Stylesheet"/>
    <link type="text/css" href="/publish/libs/layouts/simple/simple_layout.css" rel="Stylesheet"/>

     <!--[! These are shared by all CIAPI widgets -->
    <script>var flensed = { base_path: "/publish/libs/flXHR-1.0.6/" };</script>
    <script src="/publish/libs/flXHR-1.0.6/flXHR.js"></script>
    <script src="/publish/Authentication/js/libs/CIAPI.debug.js"></script>
    <script src="/publish/Authentication/js/libs/CIAPI.widget.debug.js"></script>

    <!--[! Enable mock data -->
    <script src="/publish/CIAPI/test/CIAPI.amplify.requests.mock.js"></script>
    <!--[!  CC735158 / password are valid mock credentials -->

    <!--[! This is for CIAPI.authentication widget -->
    <!-- css concatenated and minified via ant build script-->
    <link type="text/css" href="css/authentication.css" rel="Stylesheet"/>
    <!-- end css-->
    <!-- scripts concatenated and minified via ant build script-->
    <script src="js/authentication.js"></script>
    <!-- end scripts-->

</head>
<body>
    <!--[! Themeswitcher tool -->
    <div id="switcher" style="float:right"></div>
    <script type="text/javascript" src="/publish/libs/jquery-ui/Super-Theme-Switcher/jquery.themeswitcher.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#switcher').themeswitcher({
                imgpath: "/publish/libs/jquery-ui/Super-Theme-Switcher/images/",
                additionalThemes: [
                { title: "City Index", name: "ci.default",
                  icon: "theme_90_cityindex.png", url: "/publish/libs/themes/ci.default/ci.default.css" }
                    ]
            });
        });
    </script>

<script>
    //These default connection options must be set before interacting with CIAPI,
    //unless mock requests are being included above
    CIAPI.connection.ServiceUri = "http://174.129.8.69/TradingApi";
    CIAPI.connection.StreamUri = "http://pushpreprod.cityindextest9.co.uk";
</script>

<div class="wrapper">
    <div class="header">
        <div class="logo"></div>
        <div class="header-right">
            <div id="CustomAuthenticationWidget"></div>
        </div>
    </div>
    <div class="content-sidebar">
        <div class="content">
            <div id="CustomAuthenticationWidget2"></div>
        </div>
        <div class="sidebar">
            <div id="CustomAuthenticationWidget3"></div>
        </div>

    </div>

</div>


<script>
    $(document).ready(function () {
        $("#customAuthWidgetTemplate").template("customAuthWidgetTemplate"); //compile & name the template
        $('#CustomAuthenticationWidget').CIAPI_widget_AuthenticationWidget(
            {
                template: 'customAuthWidgetTemplate', //override the default template
                width: 400,
                afterLogOn: function (data) {
                    console.log("afterLogOn for CustomAuthenticationWidget", data);
                },
                afterLogOff: function (data) {
                    console.log("afterLogOff for CustomAuthenticationWidget", data);
                }
            });

        $('#CustomAuthenticationWidget2').CIAPI_widget_AuthenticationWidget(
        {
            template: 'customAuthWidgetTemplate', //override the default template
            width: 600,
            shakeOnError: true
        });

        $('#CustomAuthenticationWidget3').CIAPI_widget_AuthenticationWidget(
        {
            template: 'customAuthWidgetTemplate', //override the default template
            width: 300
        });
    });
</script>
<script id="customAuthWidgetTemplate" type="text/x-jquery-tmpl">
    <div class="ui-ciapi-authentication ui-widget ui-widget-content ui-corner-all">
        <div class="ui-ciapi-logon-view  ui-corner-all" data-bind="visible: activeView() === 'LogOn'">
            <form class="ui-ciapi-authentication-form">
            <div class="ui-ciapi-authentication-content ui-widget-content ui-corner-top">
                <p class="ui-state-error" data-bind="text: errorMessage, visible: errorMessage().length > 0"></p>
                <fieldset>
                    <label for="username">UserName</label>
                    <div class="ui-ciapi-authentication-input ui-corner-all ui-widget-content">
                        <input type="text"
                           name="username"
                           id="username"
                           class="required inputFields"  
                           data-bind="value: username"/>
                    </div>
                    <label for="password">Password</label>
                    <div class="ui-ciapi-authentication-input ui-corner-all ui-widget-content">
                        <input type="password"
                           name="password"
                           id="password"
                           class="required inputFields"  
                           data-bind="value: password"/>
                    </div>

                </fieldset>
            </form>
            </div>
            <div class="ui-ciapi-authentication-buttonpane ui-widget-content ui-helper-clearfix ui-corner-bottom">
                <button class="ui-ciapi-authentication-button" data-bind="click: doLogOn">Log on</button>
            </div>
        </div>
        <div class="ui-ciapi-logoff-view  ui-corner-all" data-bind="visible: activeView() === 'LogOff'">
            <div class="ui-ciapi-authentication-content ui-widget-content">
                <p>You are logged in as <span data-bind="text: username"/></p>
            </div>
            <div class="ui-ciapi-authentication-buttonpane ui-widget-content ui-helper-clearfix">
                <button class="ui-ciapi-authentication-button" data-bind="click: doLogOff">Log off</button>
            </div>
        </div>
    </div>
</script>


</body>
</html>

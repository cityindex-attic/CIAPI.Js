<!doctype html>
<head>
    <title>Authentication demo</title>

    <!--[! We expect these to already be loaded in the "deployment" page -->
    <script type="text/javascript" src="/publish/libs/jquery/1.5.1/jQuery.debug.js"></script>
    <script type="text/javascript" src="/publish/libs/jquery.tmpl.min.js"></script>
    <script type="text/javascript" src="/publish/libs/json2.js"></script>
    <script type="text/javascript" src="/publish/libs/jquery-ui/1.8.11/js/jquery-ui.min.js"></script>
    <!--<link type="text/css" href="../../libs/jquery-ui/1.8.11/css/dark-hive/jquery-ui-1.8.11.custom.css" rel="Stylesheet"/>-->

    <!--[! These are shared by all CIAPI widgets -->
    <script src="/publish/CIAPI/js/CIAPI.debug.js"></script>
    <script src="/publish/CIAPI.widget/js/CIAPI.widget.debug.js"></script>

    <!--[! Enable mock data -->
    <script src="/publish/CIAPI/test/CIAPI.amplify.requests.mock.js"></script>
    <!--[!  CC735158 / password are valid mock credentials -->

    <!--[! This is for CIAPI.authentication widget -->
    <!-- scripts concatenated and minified via ant build script-->
    <script src="js/authentication.js"></script>
    <!-- end scripts-->

    <link type="text/css" href="themes/ci.default/ci.default.css" rel="Stylesheet"/>
    <link type="text/css" href="themes/ci.default/style.css" rel="Stylesheet"/>
</head>
<body>
    <!--[! Themeswitcher tool -->
    <div id="switcher" style="float:right"></div>
    <script type="text/javascript" src="/publish/libs/jquery-ui/Super-Theme-Switcher/jquery.themeswitcher.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#switcher').themeswitcher({
                imgpath: "/publish/libs/jquery-ui/Super-Theme-Switcher/images/",
                additionalThemes: [
                    { title: "City Index", name: "ci.default", icon: "???", url: "themes/ci.default/ci.default.css" }
                ]
            });
        });
    </script>

<script>
    //These default connection options must be set before interacting with CIAPI,
    //unless mock requests are being included above
    CIAPI.connection.ServiceUri = "http://174.129.8.69/TradingApi";
    CIAPI.connection.StreamUri = "http://pushpreprod.cityindextest9.co.uk";
</script>

<p>A default authentication widget</p>

<div id="DefaultAuthenticationWidget" style="width: 250px"></div>
<script>
    $(document).ready(function() {
        $('#DefaultAuthenticationWidget').CIAPI_widget_AuthenticationWidget(); //inject the widget into the div
    });
</script>

<hr>

<table border="0" width="100%">
    <tr>
        <td>
            <p>A authentication widget with a custom template</p>
            <div id="CustomAuthenticationWidget"></div>
        </td>
        <td>
            <p>A second instance with same custom template</p>
            <div id="CustomAuthenticationWidget2"></div>
        </td>
    </tr>
</table>

<script>
    $(document).ready(function () {
        $("#customAuthWidgetTemplate").template("customAuthWidgetTemplate"); //compile & name the template
        $('#CustomAuthenticationWidget').CIAPI_widget_AuthenticationWidget(
            {
                template: 'customAuthWidgetTemplate', //override the default template
                afterLogOn: function (data) {
                    console.log("afterLogOn for CustomAuthenticationWidget", data);
                },
                afterLogOff: function (data) {
                    console.log("afterLogOff for CustomAuthenticationWidget", data);
                }
            });

        $('#CustomAuthenticationWidget2').CIAPI_widget_AuthenticationWidget(
        {
            template: 'customAuthWidgetTemplate' //override the default template
        });
    });
</script>
<script id="customAuthWidgetTemplate" type="text/x-jquery-tmpl">
    <div class="ui-ciapi-authentication ui-widget ui-corner-all">
        <div class="ui-ciapi-logon-view  ui-corner-all" data-bind="visible: activeView() === 'LogOn'">
            <div class="ui-ciapi-authentication-content ui-widget-content ui-corner-top">
                <p class="ui-state-error" data-bind="text: errorMessage, visible: errorMessage().length > 0"></p>
                <fieldset>
                    <label for="username">UserName</label>
                    <div class="ui-ciapi-authentication-input  ui-corner-all">
                        <input type="text"
                           name="username"
                           id="username"
                           class="inputFields"
                           data-bind="value: username"/>
                    </div>
                    <label for="password">Password</label>
                    <div class="ui-ciapi-authentication-input  ui-corner-all">
                        <input type="password"
                           name="password"
                           id="password"
                           class="inputFields"
                           data-bind="value: password"/>
                    </div>

                </fieldset>
            </div>
            <div class="ui-ciapi-authentication-buttonpane ui-widget-content ui-helper-clearfix ui-corner-bottom">
                <button class="ui-ciapi-authentication-button" data-bind="click: doLogOn">Log on</button>
            </div>
        </div>
        <div class="ui-ciapi-logoff-view  ui-corner-all" data-bind="visible: activeView() === 'LogOff'">
            <div class="ui-ciapi-authentication-content ui-widget-content">
                <p>You are logged in as <span data-bind="text: username"/></p>
            </div>
            <div class="ui-ciapi-authentication-buttonpane ui-widget-content ui-helper-clearfix">
                <button class="ui-ciapi-authentication-button" data-bind="click: doLogOff">Log off</button>
            </div>
        </div>
    </div>
</script>


</body>
</html>
